<main class="edit-painting-container">
  <div class="page-header">
    <button class="back-btn" (click)="goBack()">
      <fa-icon [icon]="faArrowLeft"></fa-icon>
      Back to Profile
    </button>
    <h1>Edit Painting</h1>
  </div>

  <div *ngIf="loading" class="loading-container">
    <p>Loading painting details...</p>
  </div>

  <div *ngIf="error && !loading" class="error-message">
    {{ error }}
  </div>

  <div *ngIf="success" class="success-message">
    {{ success }}
  </div>

  <div *ngIf="!loading && painting" class="edit-content">
    <div class="content-grid">
      <div class="painting-preview">
        <div class="preview-header">
          <h2>Current Painting</h2>
        </div>

        <div class="painting-card">
          <div class="painting-image">
            <img [src]="painting.image" [alt]="painting.title" />
          </div>

          <div class="painting-info">
            <h3>{{ painting.title }}</h3>
            <div class="painting-meta">
              <span class="category">
                {{
                  painting.category === "digital"
                    ? "Digital Art"
                    : "Canvas/Traditional"
                }}
              </span>
              <span class="dimensions">
                {{ painting.dimensions.width }}×{{ painting.dimensions.height
                }}{{ painting.dimensions.unit }}
              </span>
            </div>
            <p class="description">{{ painting.description }}</p>
            <div class="stats">
              <span>{{ painting.ratingCount }} ratings</span>
              <span>•</span>
              <span>{{ painting.commentCount }} comments</span>
              <span>•</span>
              <span>Created {{ formatDate(painting.createdAt) }}</span>
            </div>
          </div>
        </div>
      </div>

      <div class="edit-form-section">
        <div class="form-header">
          <h2>Edit Details</h2>
        </div>

        <form (ngSubmit)="savePainting()" class="edit-form">
          <div class="form-group">
            <label for="title">Title *</label>
            <input
              type="text"
              id="title"
              [(ngModel)]="editForm.title"
              name="title"
              required
              maxlength="100"
              placeholder="Enter painting title"
            />
            <small class="char-count"
              >{{ editForm.title.length }}/100 characters</small
            >
          </div>

          <div class="form-group">
            <label for="category">Category</label>
            <select
              id="category"
              [(ngModel)]="editForm.category"
              name="category"
            >
              <option value="digital">Digital Art</option>
              <option value="canvas">Canvas/Traditional</option>
            </select>
          </div>

          <div class="form-group">
            <label for="description">Description</label>
            <textarea
              id="description"
              [(ngModel)]="editForm.description"
              name="description"
              rows="6"
              maxlength="1000"
              placeholder="Describe your painting, techniques used, inspiration, etc."
            ></textarea>
            <small class="char-count"
              >{{ editForm.description.length }}/1000 characters</small
            >
          </div>

          <div class="form-actions">
            <button type="button" class="cancel-btn" (click)="cancelEdit()">
              <fa-icon [icon]="faTimes"></fa-icon>
              Cancel
            </button>

            <button
              type="submit"
              class="save-btn"
              [disabled]="saving || !isFormValid()"
              [class.has-changes]="hasChanges()"
            >
              <fa-icon [icon]="faSave"></fa-icon>
              <span *ngIf="saving">Saving...</span>
              <span *ngIf="!saving">Save Changes</span>
            </button>
          </div>

          <div *ngIf="hasChanges()" class="changes-indicator">
            <p>You have unsaved changes</p>
          </div>
        </form>
      </div>
    </div>
  </div>
</main>
